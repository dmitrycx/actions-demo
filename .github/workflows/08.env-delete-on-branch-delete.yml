# .github/workflows/env-delete-on-branch-delete.yml
name: Env cleanup â€“ on branch delete

on:
  delete:

jobs:
  cleanup:
    if: github.event.ref_type == 'branch'
    runs-on: ubuntu-latest
    permissions:
      contents: read
      deployments: write

    steps:
      - name: Delete env matching the deleted branch
        uses: strumwolf/delete-deployment-environment@v3
        with:
          # envs are named "demo-<branch>"
          environment: demo-${{ github.event.ref }}
          token: ${{ secrets.GITHUB_TOKEN }}
